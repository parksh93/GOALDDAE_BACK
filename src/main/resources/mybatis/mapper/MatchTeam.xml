<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goalddae.repository.MatchTeamRepository">
    <update id="createMatchTeamTable" parameterType="java.lang.Long">
        CREATE TABLE match_team_#{id} (
                                            id BIGINT AUTO_INCREMENT PRIMARY KEY,
                                            team_id VARCHAR(255) NOT NULL,
                                            likes BIGINT default 0 NOT NULL,
                                            views BIGINT default 0 NOT NULL,
                                            gender VARCHAR(255) NOT NULL,
                                            minimum BIGINT NOT NULL,
                                            maximum BIGINT NOT NULL,
                                            player_number BIGINT NOT NULL,
                                            recruit_start DATETIME NOT NULL,
                                            recruit_end DATETIME NOT NULL,
                                            manager_id VARCHAR(255) NOT NULL,
                                            soccer_field_id BIGINT NOT NULL,
                                               FOREIGN KEY (soccer_field_id) REFERENCES soccer_field(id),
                                            field_reservation_id BIGINT NOT NULL
        );
    </update>

    <!-- 동적 테이블 삭제 쿼리 -->
    <delete id="dropMatchTeamTable" parameterType="java.lang.Long">
        DROP TABLE IF EXISTS match_Team_#{id}
    </delete>

    <!-- 외래키 제약 추가 쿼리 작성 -->
    <update id="addForeignKeyConstraintToMatchTeam" parameterType="java.lang.Long">
        ALTER TABLE match_team_#{id}
            ADD FOREIGN KEY (field_reservation_id) REFERENCES field_reservation_#{fieldName}(id)
    </update>
</mapper>
